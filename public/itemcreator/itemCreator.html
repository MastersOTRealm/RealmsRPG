<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/styles/main.css">
    <link rel="stylesheet" href="/styles/itemCreator.css">
    <script type="module" src="./itemCreator.js" defer></script>
</head>
<body>
    <header id="header"></header>
    <main>
        <div id="generalItemOptionsContainer">
            <h3 class="centered-title">General Item Options</h3>
            <div class="option-container">
                <div class="option-box range-box">
                    <h4>Range: <span id="rangeValue">Melee</span>
                        <div class="button-container">
                            <button class="small-button blue-button" onclick="changeRange(1)">+</button>
                            <button class="small-button blue-button" onclick="changeRange(-1)">-</button>
                        </div>
                    </h4>
                </div>
                <div class="option-box handedness-box">
                    <h4>Handedness:
                        <select id="handedness" onchange="changeHandedness(this.value)">
                            <option value="One-Handed" selected>One-Handed</option>
                            <option value="Two-Handed">Two-Handed</option>
                        </select>
                    </h4>
                </div>
                <div class="option-box damage-box">
                    <h4>Damage: 
                        <input type="number" id="dieAmount1" min="1" max="99" value="" placeholder="Amount"> d 
                        <select id="dieSize1">
                            <option value="" selected disabled>Size</option>
                            <option value="2">2</option>
                            <option value="4">4</option>
                            <option value="6">6</option>
                            <option value="8">8</option>
                            <option value="10">10</option>
                            <option value="12">12</option>
                        </select>
                        <select id="damageType1" onchange="updateDamageType()">
                            <option value="none" selected>No Damage</option>
                            <option value="blunt">Blunt</option>
                            <option value="piercing">Piercing</option>
                            <option value="slashing">Slashing</option>
                        </select>
                        <button id="addDamageRowButton" class="medium-button blue-button" onclick="addDamageRow()">+</button>
                    </h4>
                    <div id="additionalDamageRow"></div>
                </div>
            </div>
        </div>
        <div class="button-row">
            <button id="addShieldPartButton">Add Shield Part</button>
            <button id="addItemPartButton">Add Weapon Part</button>
            <button id="addArmorPartButton">Add Armor Part</button>
        </div>
        <div id="itemPartsContainer"></div>
        <div id="itemSummary">
            <h3>Item Summary</h3>
            <div class="item-summary-top">
                <input type="text" id="itemName" placeholder="Item Name" style="flex: 1;">
                <div class="load-save-button-container" style="display: flex; flex-direction: column;">
                    <button id="add-to-library-button" class="add-to-library-button">Add to Library</button>
                </div>
                <p>Total IP: <span id="summaryIP">0</span></p>
                <p>Building Points: <span id="summaryBP">0</span></p>
                <p>Gold Points: <span id="summaryGP">0</span></p>
                <p>Range: <span id="summaryRange">Melee</span></p>
                <p id="summaryDamage" style="display: none;"></p>
                <p>Rarity: <span id="summaryRarity">Common</span></p>
            </div>
            <div class="item-summary-parts">
                <h4>Item Parts:</h4>
                <div id="summaryParts"></div>
            </div>
            <div class="item-summary-description">
                <h4>Description:</h4>
                <textarea id="itemDescription" placeholder="Item Description"></textarea>
            </div>
        </div>
        <div id="totalCosts">
            <h3>Total Item Costs</h3>
            <p>Total IP: <span id="totalIP">0</span></p>
            <p>Total BP: <span id="totalBP">0</span></p>
            <p>Total GP: <span id="totalGP">0</span></p>
            <p>Rarity: <span id="totalRarity">Common</span></p>
            <div class="toggle-arrow"><</div>
        </div>
    </main>
    <footer id="footer"></footer>
    <script type="module">
        import { initializeFirebase, handleAuthStateChange } from '/scripts/auth.js';

        async function loadHeaderFooter() {
            const header = document.getElementById('header');
            const footer = document.getElementById('footer');
            if (header) {
                header.innerHTML = await fetch('/header.html').then(response => response.text());
            }
            if (footer) {
                footer.innerHTML = await fetch('/footer.html').then(response => response.text());
            }
        }
        loadHeaderFooter();

        document.addEventListener('DOMContentLoaded', async function() {
            const { auth, db } = await initializeFirebase();
            handleAuthStateChange(auth, db);
        });
    </script>
</body>
</html>
